<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="msapplication-TileImage" content="{{ url_for('static', filename='img/favicons/mstile-150x150.png') }}">
    <meta name="theme-color" content="#ffffff">
    <meta http-equiv="refresh" content="600"> <!-- Atualiza a cada 10 minutos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css"> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="{{url_for('static', filename='css/theme.css') }}" rel="stylesheet">
    <link href="{{url_for('static', filename='css/style_lista.css') }}" rel="stylesheet">
    <link href="{{url_for('static', filename='css/styleTable.css') }}" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='img/favicons/apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href= "{{ url_for('static', filename='img/favicons/favicon-32x32.png') }}" >
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='img/favicons/favicon-16x16.png') }}">
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='img/favicons/favicon.ico') }}">
    <link rel="manifest" href="{{ url_for('static', filename='img/favicons/manifest.json') }}">
    <script src="{{ url_for('static', filename='js/botaonotificar.js') }}"></script>

</head>
<body>
<main class="main"  id="top">
    <nav class="navbar navbar-expand-lg navbar-light fixed-top py-2 px-0" data-navbar-on-scroll="data-navbar-on-scroll">
		<div class="container" ><a class="navbar-brand fw-bold order-1" href="index.html"> </a>
          <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
          <div class="collapse navbar-collapse w-lg-auto order-3 order-lg-0 border-top border-lg-top-0 border-200 mt-3" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item"><a class="nav-link text-500 px-2 ml-lg-n2 active" style="font-weight: bold;" href="https://bigdatasystems.com.br/" target="_blank">BigDataSystems</a></li>
              <li class="nav-item"><a class="nav-link text-500 px-2 ml-lg-n2 active" aria-current="page" href="{{url_for('principal')}}">Dashboard web</a></li>
              <li class="nav-item"><a class="nav-link text-500 px-2" href="{{url_for('sobre')}}">Conceitos dashboard</a></li>
              <li class="nav-link disabled"><a href="">Metricas Mensais</a></li>
            </ul>
        </div>
        <button style="margin-top:20px" type="button" onclick="confirmarAcao()" class="btn btn-warning" data-toggle="tooltip" data-placement="right" title="Resetar Notificações">
            Resetar Notificações
          </button>    
          <div class="image-container" 
                style="text-align:right;
                      text-align: center; /* Centraliza o conteúdo dentro do elemento pai */ 
                      collor:black;                      
                      margin-top:30px; 
                      float: right;
                      position: absolute;
                      right: -90px;">
            <img  src="{{ url_for('static', filename='img/icons/user.png')}}" alt="Minha Imagem" 
                style="width: 40px; height: auto;"> 
            <p>{{user}}</p>

        </div>

    {% block styles %}
    {% endblock %}
    </nav>
    <section class="py-0" id="home" ">
        <div class="bg-holder d-none d-lg-block backuground_img"></div>
          <!--/.bg-holder-->
          <div class="bg-holder d-lg-none backuground_img2"></div>

        <!--/.bg-holder-->
        <div class="container">
           
            <div class="row align-items-center min-vh-100" >
    
                <div class="col-md-7 col-lg-6 py-6 text-md-start text-center">       
            <div>
            <h1 class="lead text-muted" 
                style="color: rgb(255, 255, 255); 
                       text-decoration: none; 
                       font-size: 35px;
                        font-weight: bold;
                        text-align: center;
                        margin-top: 40px;
                        width: 800px;"
                       >Monitoração WEB - Flexpag</h1>
            </div>
            <table class="table table-bordered table-hover table-striped">
            
                <div class="col">
                    <div class="destaque lead text-muted" style="text-align: right; 
                                                 font-weight: bold; 
                                                 font-size: 0.9em; 
                                                 font-style: italic;
                                                 color: #333;
                                                 margin-top: 20px;
                                                 margin-bottom: 10px;
                                                 float: left;">Atualizado em {{date}}</div>
                </div>
                <thead class="table-dark">
                    <tr>
                      <th scope="col">Empresa</th>
                      <th style="text-align: center;" scope="col">Ambiente</th>
                      <th style="text-align: center;" scope="col">Quantidade</th>
                      <th style="text-align: center;" scope="col">Data_ultima_transacao</th>
                      <th style="text-align: center;" scope="col">Hora_ultima_transacao</th>
                      <th style="text-align: center;" scope="col">gap_time</th>
                      <th style="text-align: center;" scope="col">Farol</th>
                      <th style="text-align: center;" scope="col">Notificações</th>
                    </tr>
                </thead>
                <tbody>
                {% for col in transacoes %}
                <tr>
                    <td>{{col.empresa}}</td>
                    <td style="text-align: center;">{{col.ambiente}}</td>
                    <td style="text-align: center;">{{col.quantidade}}</td>
                    <td style="text-align: center;">{{col.data_ultima_transacao}}</td>
                    <td style="text-align: center;">{{col.hora_ultima_transacao}}</td>
                    <td style="text-align: center;">{{col.gap_time}}</td>
                    <td id="status_processo" 
                            style="text-align: center;" 
                            class="light {{col.farol}}-light">
                        <div class="light-dot"></div>
                        <span class="farol-text" style="display: none;">{{col.farol}}</span></td>
                        <td>
                            <!-- Botão para tomar ações com base no valor de col.farol -->
                            <button id="notificarBtn{{ col.company_id }}" class="btn btn-secondary btn-sm" 
                                onclick="notificarCliente({{ col.company_id }}, '{{ col.farol }}')" 
                                {% if col.company_id in clientes_notificados %} 
                                    disabled 
                                {% endif %}
                            >
                                {% if col.farol == 'green' %}
                                    Notificar
                                {% elif col.company_id in clientes_notificados %}
                                    Notificado
                                {% else %}
                                    Notificar
                                {% endif %}
                            </button>
                        </td>
                    </tr>
                    {% if col.farol == 'green' %}
                        <script>
                            // Normalizar o cliente se o farol estiver verde
                            normalizarCliente({{ col.company_id }});
                            console.log("Cliente normalizado:", {{ col.company_id }});
                        </script>
                        {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>
            </div>
        </div>
    </section>
    </main>
</div>
<!-- Rodapé -->
<div class="rodape">
<p>Todos os direitos reservados &copy; 2024</p>
</div>
<!-- ===============================================-->
<!--    JavaScripts-->
<!-- ===============================================-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="./static/vendors/popper/popper.min.js"></script>
<script src="./static/vendors/bootstrap/bootstrap.min.js"></script>
<script src="./static/vendors/anchorjs/anchor.min.js"></script>
<script src="./static/vendors/is/is.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
<script src="./static/js/theme.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet">

<script>
    setTimeout(function(){
        location.reload();
    }, 600000); // Atualiza a cada 10min (600000 milissegundos)
</script>

</body>

</html>